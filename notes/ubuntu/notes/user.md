# ユーザー
1. [ユーザー情報 ( /etc/passwd )](#anchor1)
2. [ユーザー作成 ( adduser )](#anchor2)
3. [パスワード変更 ( passwd )](#anchor3)
4. [パスワード生成 ( pwgen )](#anchor4)
5. [ユーザー削除 ( userdel )](#anchor5)
6. [ユーザー情報変更 ( usermod )](#anchor6)
7. [アカウント期限変更 ( chage )](#anchor7)

<a id="anchor1"></a>

## 1. ユーザー情報 ( /etc/passwd )
 - システムに登録されたユーザー情報は **/etc/passwd** ファイルに記録されています。

    ```:コマンド
    cat /etc/passwd
    ```

 - /etc/passwd 情報

    ```:コマンド例
    hoge : x : 1000 : 1000 : hoge : /home/hoge : /bin/bash
      1      2       3         4         5         6                    7
    ```

    |項番|説明|
    |---|---|
    |1. ユーザー名|システムで重複しない名前です。|
    |2. パスワード|かつてパスワードが格納されていた項目です。**/etc/shadow** に記録されています。|
    |3. ユーザー ID ( UID )|ユーザーを識別するための一意の数値です。|
    |4. グループ ID ( GID )|ユーザーの所属するプライマリグループの GID です。|
    |5. コメント|コメント欄です。省略可能です。|
    |6. ホームディレクトリ|ユーザーのホームディレクトリです。|
    |7. デフォルトシェル|ログイン時に使用されるシェルのパスです。|

### プロンプト情報

 ```:表示例
 ユーザー名 ＠ ホスト名 : カレントディレクトリ $
 ```

<a id="anchor2"></a>

## 2. ユーザー作成 ( adduser  )
 - ユーザーを作成すると以下のような処理も自動で行われます。
1. ユーザー名と同じ名前のグループを作成
2. ホームディレクトリを **/home/ユーザー名** で作成
3. 初期設定ファイルをホームディレクトリ内にコピー ( 初期設定ファイルのひな形は **/etc/skel** ディレクトリに格納されています )

    ```:コマンド
    sudo ls -lA /etc/skel
    ```

### adduser コマンド
 - UbuntuServer ではデフォルトでホームディレクトリが作成されません。**-d** オプションで指定する必要があります。
 - パスワードは別途 **passwd** コマンドで設定する必要があります。

    ```:コマンド
    sudo adduser -d [ オプション ] < ユーザー名 >
    ```

<a id="anchor3"></a>

## 3. パスワード変更 ( passwd  )
 - 一般ユーザーは自身のパスワードのみ変更できます。
 - 管理者権限 ( sudo ) では、他のユーザーのパスワードも変更できます。
 - パスワードの文字数制限などは **/etc/pam.d/common-password** ファイルで設定します。

    ```:コマンド
    passwd [ オプション ] < ユーザー名 >
    ```

<a id="anchor4"></a>

## 4. パスワード生成 ( pwgen )
 - **pwgen** パッケージをインストールすると生成することができます。
 - より高度なパスワード生成コマンドとして **apg** パッケージが存在します。ここでは省略。
 - インストール

    ```:コマンド
    sudo apt -y install pwgen
    ```

 - 引数無しの場合、多数のパスワード候補 ( 英数字８文字 ) が表示されます。

    ```:コマンド
    pwgen [ オプション ] [ 文字数 ] [ 生成数 ]
    ```

    |オプション|説明|
    |---|---|
    |-O|数字を使用しません。|
    |-c|最低１文字は大文字を使用します。|
    |-y|記号も使用します。|
    |-A|英大文字を使用しません。|
    |-B|紛らわしい文字を排除します。|

<a id="anchor5"></a>

## 5. ユーザー削除 ( userdel  )
 - デフォルトではユーザー情報のみが削除され、ホームディレクトリは残ります。
 - ホームディレクトリも同時に削除する場合は、**-r** オプションを使用します。

    ```:コマンド
    userdel [ -r ] < ユーザー名 >
    ```

<a id="anchor6"></a>

## 6. ユーザー情報変更 ( usermod  )
 - ユーザーのホームディレクトリやデフォルトシェル、参加グループの変更する場合に使用します。

    ```:コマンド
    usermod [ オプション ] < ユーザー名 >
    ```

    |オプション|説明|
    |---|---|
    |-c < コメント >|コメントを変更します。|
    |-d < パス >|ホームディレクトリのパスを変更します。|
    |-g < グループ名 >|プライマリグループを変更します。|
    |-G < グループ名 >|所属グループを変更します。|
    |-aG < グループ名 >|所属グループを追加します。|
    |-s < パス >|デフォルトシェルを変更します。|
    |-L|アカウントロックをします。|
    |-U|アカウントロックを解除します。|

<a id="anchor7"></a>

## 7. アカウント期限変更 ( chage )
 - ユーザーアカウントの期限やパスワード更新間隔の設定をします。
 - これらの情報は、**/etc/shadow** ファイルに格納されます。

    ```:コマンド
    chage [ オプション ] < ユーザー名 >
    ```

    |オプション|説明|
    |---|---|
    |-l|パスワードやアカウントの有効期限を表示します。**never** は設定されていないという表示です。|
    |-m < 日数 >|パスワード変更間隔の最低日数を設定します。|
    |-M < 日数 >|パスワードの最大有効期限日数を設定します。|
    |-d < 日付 >|パスワードの最終更新日を設定します。|
    |-W < 日数 >|パスワードの有効期限切れ通知を何日前から表示するか設定します。|
    |-l < 日数 >|パスワードの有効期限切れ後、アカウントロックまでの日数を設定します。|
    |-E < 日付 >|ユーザーアカウントが無効となる日付を設定します。|
