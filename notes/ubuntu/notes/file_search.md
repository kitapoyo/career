# Ubuntu File Search
1. [locate コマンド](#anchor1)
   - ファイル名データベースの更新
2. [find コマンド](#anchor2)
   - 検索例

<a id="anchor1"></a>

## 1. locate コマンド
 - ファイルの絶対パスの中に指定したキーワードが含まれるファイルを検索します。
 - あらかじめ作成したファイル名データベースを検索するため、更新された後のデータは検索できません。
 - ファイル名以外で検索することもできません。

    ```:書式
    locate キーワード
    ```

### ファイル名データベースの更新
 - ファイル名データベースは cron によって、１日１回更新されます。
 - 手動で更新する場合は、以下のコマンドを実行してください。

    ```:コマンド
    sudo /etc/cron.daily/mlocate
    ```

<a id="anchor2"></a>

## 2. find コマンド
 - 様々な条件 ( ファイル名・アクセス権・サイズ・アクセス日時 ) で、ファイルを検索できます。
 - 指定ディレクトリ以下のファイルを検索します。指定がない場合はカレントディレリクトリ以下が検索対象です。
 - アクセス権のないディレクトリは検索できません。

     ```:書式
     find [ 検索ディレリクトリ ] [ 検索式 ]
     ```

    |検索式|説明|
    |---|---|
    |-maxdepth < LEVEL >|指定したディレクトリから最大 LEVEL 階層下のディレクトリまで検索します|
    |-mindepth < LEVEL >|指定したディレクトリから LEVEL 階層下から検索します|
    |-name < ファイル名 >|ファイル名で検索します|
    |-mtime < 日数 >|最終更新日時で検索します|
    |-perm < モード >|パーミッションで検索します|
    |-size < サイズ >|ファイルサイズで検索します( c : byte , k : Kbyte , m : Mbyte , デフォルトはブロック )|
    |-regex < 正規表現 >|ファイル名を正規表現で検索します|
    |-type < タイプ >|ファイルタイプを指定して検索します ( f : ファイル , d : ディレクトリ , l : シンボリックリンク )|
    |-user < ユーザー名 >|指定したユーザーが所持者のファイルを検索します|
    |-group < グループ名 >|指定したグループが所有グループのファイルを検索します|
    |-ls|検索結果を ` ls -l ` のように表示します|
    |-print|検索結果を表示します ( デフォルト )|
    |-and|検索式を論理積でつなぎます ( デフォルト )|
    |-or|検索式を論理和でつなぎます|
    |-exec コマンド \;|検索結果に対してコマンドを実行します|
    |-ok コマンド \;|検索結果に対してコマンドを確認しながら実行します|

### 検索例
 - カレントディレクトリ以下から、ファイルの末尾が「.gz」のファイルを検索

    ```:コマンド
    find . -name "*.gz"
    ```

 - /data ディレクトリ以下から、過去３日以内に更新されたファイルのみを検索

    ```:コマンド
    find /data -type f -mtime -3
    ```

 - /usr/sbin ディレクトリ以下から、SUID が設定されたファイルを検索

    ```:コマンド
    find /usr/sbin -perm -u+s -ls
    ```
 - カレントディレクトリ以下から、所有者 hoge のファイルやディレクトリを検索

    ```:コマンド
    find . -user hoge
    ```

 - カレントディレクトリ以下から、ファイルサイズ １００Kバイト以上の tar ファイルを検索

    ```:コマンド
    find . -size +100k -type f -name "*.tar"
    ```

 - カレントディレクトリ以下から、最終アクセス日時３０日以前のファイルを検索

    ```:コマンド
    find . -atime +30
    ```

 - カレントディレクトリ以下から、最終アクセス日時１００日以前のファイルを検索し、削除

    ```:コマンド
    find . -atime +100 -exec rm {} \;
    ```
