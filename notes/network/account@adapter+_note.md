# Account@Adapter+ Note
1. [概要](#anchor1)
2. [管理者ログイン](#anchor2)
3. [ライセンス登録](#anchor3)
4. [ネットワーク設定](#anchor4)
5. [認証設定](#anchor5)
6. [バックアップ](#anchor6)
   - バックアップを転送する場合の設定内容
   - バックアップファイルのダウンロード
   - バックアップファイルのアップロード
7. [リストア](#anchor7)
   - スレイブサーバー同期
   - リストア対象の情報
8. [コンソール操作](#anchor8)
   - localuser の操作

<a id="anchor1"></a>

## 1. 概要
 - **ライセンス更新に伴うサービス再起動**はありません。
 - ブラウザは **Microsoft Edge** が推奨です。
 - スレーブサーバーは、冗長設定が未設定の場合や、マスターサーバーと同期を開始していない場合は管理ツールを使用できません。
 - 別途有償のオプションを追加することにより、各オプション機能が使用可能になります。
1. 外部LDAP/AD 参照オプション<br>LDAP サーバーや Active Directory に登録しているアカウント情報で認証ができます。
2. DHCP オプションライセンス<br>DHCP サーバー機能を使用できます。

<a id="anchor2"></a>

## 2. 管理者ログイン
 - アプライアンス機に初期設定されているサーバーIP アドレスは **192.168.0.1/24** です。<br>固定管理者の ID、初期パスワードとも **naadmin** となります。

    ```:書式
    http://AccountAdapter IP address:8080/manager/
    ```

<a id="anchor3"></a>

## 3. ライセンス登録
 - ライセンスが未登録の場合、最初に Account@Adapter+ のライセンスを登録する必要があります。
 - **管理ツールにログイン** > **メニュー 環境設定** > **ライセンス**<br>ライセンス欄にライセンスキーを入力し、区分欄で「マスターサーバー」「スレーブサーバー」を選択して登録してください。
 - 登録された情報は **ライセンス登録一覧** の **Account@Adapter+** に表示されます。

<a id="anchor4"></a>

## 4. ネットワーク設定
 - メンテナンスツールのメニュー **ネットワーク設定** をクリックすると「ネットワーク設定」画面を表示します。
 - **eth0** の設定を初期設定から変更し、画面下部にある **登録** ボタンをクリックして登録します。

<a id="anchor5"></a>

## 5. 認証設定
 - 内部アカウントで RADIUS 認証を行うための設定について説明します。
1. ディレクトリの作成<br>内部アカウントを格納するディレクトリを作成します。
2. アカウントの登録<br>作成したディレクトリにアカウントを登録します。
3. RADIUS クライアント登録<br>RADIUS クライアントを登録します。
4. CA 設定 ( IEEE802.1X 認証の場合 )<br>内部認証局や内部サーバー証明書を設定します。
5. RADIUS 設定<br>認証方式の選択や認証の条件を設定します。
6. RADIUS 設定反映<br>**RADIUS 設定反映** ボタンをクリックして RADIUS 設定反映を実行します。
7. クライアント証明書の発行/インポート ( TLS 認証の場合 )<br>クライアント証明書ポリシーを設定します。<br>証明書アカウントの証明書を発行し、認証する端末にインポートします。

<a id="anchor6"></a>

## 6. バックアップ
 - **メニュー「メンテナンス」** > **「バックアップ/リストア」** をクリックするとバックアップ/リストア操作画面を表示します。
 - バックアップ先の変更、バックアップファイルの作成/削除、バックアップファイルのダウンロード/アップロード、リストアを行うことができます。<br>また、Account@Adapter+ 内のバックアップ格納先のバックアップファイルを一覧表示します。
 - バックアップ先を変更する場合は、バックアップ先欄の **変更** ボタンをクリックすると、バックアップ設定画面を表示します。
 - いずれの場合も **FTP** , **SFTP** , **SCP** サーバーにコピーを行う設定が可能です。<br>コピーを行うためには、転送欄を **有効** にします。
1.  アプライアンス機<br>USB メモリ、ローカルディスクから選択します。初期設定：USB メモリ
2. バーチャルアプライアンス<br>ローカルディスク固定

### バックアップを転送する場合の設定内容
 - **使用プロトコル** ：使用するプロトコルを **FTP** , **SFTP** , **SCP** から選択します。SFTP または SCP を選択した場合は、サーバー認証は **使用する** 固定になります。
 - **サーバー名:ポート番号** ：FTP サーバーの IP アドレスまたはサーバー名 ( FQDN ) とポート番号を設定します。
 - **ディレクトリ** ：転送先サーバーの保存先のディレクトリパスを設定します。ルートディレクトリを指定する場合は、**./** を入力します。
 - **サーバー認証 ( 任意 )** ：転送先サーバー接続時の認証の有無の設定を行います。

### バックアップファイルのダウンロード
 - バックアップファイル一覧の **ダウンロード** ボタンをクリックすると、バックアップファイルを管理端末にダウンロードすることができます。
 - ダウンロードできるファイルサイズは **2GB ( 2,147,483,648 byte ) 以下** です。

### バックアップファイルのアップロード
 - バックアップ/リストア操作画面から、管理端末にダウンロードして保存しているバックアップファイルをアップロードしてリストアに使用することができます。
 - **アップロード** ボタンをクリックすると、ファイルのアップロードを実行します。

<a id="anchor7"></a>

## 7. リストア
 - Account@Adapter+ 内に保存されているバックアップファイルでリストアを行います。
 - 稼働中の冗長構成で、マスターサーバーのリストアを行う場合、以下のことに注意してください。
1. マスターサーバーをネットワークから外し、スレーブサーバーと通信ができない状態でリストアを行う必要があります。
2. オンラインの状態でリストアを行った場合、スレーブサーバーの同期が停止します。
3. ローカルコンソールユーザー **localuser** のパスワードは、リストアされません。
4. **全リストアを選択した場合、リストア完了後に自動的にシステムを再起動**します。

### スレイブサーバー同期
 - **環境設定** > **冗長設定** > データ同期にチェックを入れて実行します。

### リストア対象の情報
 - **全リストア** ：そのサーバーで管理する個別設定と、マスターサーバーとスレーブサーバー間で共用するデータ部分の両方をリストアします。
 - **データリストア** ：全リストアの範囲から、サーバーの個別設定を除いた共用データ部分のみをリストアします。
 - **DHCP リース情報** ：リストアするバックアップファイルに DHCP リース情報ファイルが含まれていた場合にリストアします。
 - **ログ情報** ：、カレントのログファイルのみリストア対象とします。ローテーションされたログファイルは、リストアされません。

<a id="anchor8"></a>

## 8. コンソール操作
 - 以下のログイン ID / パスワードを入力して、ログインしてください。<br>ログイン中に１０分間操作が無いと自動ログアウトされます。

    |ログイン ID|説明|
    |----|----|
    |localadmin|固定パスワード：localadmin ( 変更不可 )<br>SSH 接続：不可<br>概要：ネットワーク設定や管理者パスワードの初期化を行う。|
    |localuser|初期パスワード：localuser ( 変更可 )<br>SSH 接続：可 ( 管理ツールによる許可設定が必要 )<br>概要：装置状態表示や ping の実行、診断情報の取得などを行う。|

### localuser の操作
 - 取得回数を省略した場合 **Ctrl キー+ C キー** を同時に押下してコンドの実行を中止してください。
 - 使用可能な引数は ` cmd arp -help ` を実行して確認してください。

    |コマンド|説明|
    |----|----|
    |cmd df|ディスク使用量を表示します。|
    |cmd free|メモリ使用量を表示します。|
    |cmd iostat|I/O 統計情報を表示します。<br>引数1：更新間隔 1～9999 秒 ( 省略可 )<br>引数2：取得回数 1～9999 回 ( 省略可 ) |
    |cmd vmstat|メモリやCPU の使用状況を表示します。<br>引数1：更新間隔 1～9999 秒 ( 省略可 )<br>引数2：取得回数 1～9999 回 ( 省略可 )|
    |cmd date|設定されている現在日時を表示します。|
    |cmd passwd|localuser のパスワードを対話型で設定します。|
    |cmd network|現在のネットワーク設定を表示します。|
    |cmd ping|指定したホストに連続してPing を実行します。<br>引数1：対象のホストのIP アドレス、またはホスト名<br>引数2：実行回数 1～9999 回 ( 省略可 )|
    |cmd arp|arp テーブルのキャッシュの操作を行います。<br>引数1：OS の arp コマンドに渡す引|
    |cmd nslookup|DNS への問い合わせを行います。<br>引数1：OS の nslookup コマンドに渡す引数
    |cmd traceroute|指定したホストに到達するまでのネットワーク上の経路を表示します。<br>引数：OS のtraceroute コマンドに渡す引数|
    |cmd ntpdate|指定した NTP サーバーから応答された時刻を設定/参照します。<br>引数1：なし ( 時刻設定 )、-q ( 時刻参照のみ )<br>引数2：NTP サーバーのIP アドレス|
    |cmd clearcache|Account@Adapter+ サーバー上にある画面操作によるキャッシュファイルをクリアします。|
    | cmd tcpdump |ネットワークの通信パケットのダンプを取得し、tftp/scp サーバーへ送信します。<br>サイズが100MB 以上になると自動終了します。<br>取得と送信で、それぞれコマンドの実行が必要です。<br>\[取得\]<br>引数1：インターフェース名 eth0 またはeth1<br>引数2：tcp コマンドのフィルター条件<br>\[送信\]<br>引数1：tftp または scp<br>引数2：tftp/scp サーバーのIP アドレス<br>引数3：scp サーバーのログインID<br>引数4：scp サーバーのパスワード
